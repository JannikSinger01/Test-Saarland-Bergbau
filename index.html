<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historischer Atlas Saarland: Kohle & Stahl</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; }
        #map { height: 100%; width: 100%; z-index: 1; }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Interaktive Items */
        .list-item { transition: all 0.2s; }
        
        .mine-item:hover {
            background-color: #fef2f2;
            border-left-color: #dc2626;
        }
        
        .steel-item:hover {
            background-color: #f0fdf4;
            border-left-color: #16a34a;
        }

        /* Leaflet Popup Anpassung */
        .leaflet-popup-content-wrapper {
            border-radius: 0.75rem;
            padding: 0;
        }
        .leaflet-popup-content {
            margin: 0 !important;
            width: 260px !important;
        }

        /* Layer Control Styling */
        .leaflet-control-layers {
            border: none !important;
            border-radius: 0.75rem !important;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1) !important;
            padding: 10px !important;
            font-family: inherit;
        }
    </style>
</head>
<body class="relative h-screen w-screen bg-gray-100">

    <!-- Header Desktop -->
    <div class="absolute top-4 left-4 z-[1000] glass-panel p-5 rounded-xl shadow-2xl max-w-xs border-l-4 border-gray-800 hidden md:block">
        <h1 class="text-2xl font-bold text-gray-800 mb-1">Industriekultur Saar</h1>
        <div class="flex gap-2 mb-2 text-xs font-bold uppercase tracking-wider">
            <span class="text-red-600">Kohle</span>
            <span class="text-gray-400">&bull;</span>
            <span class="text-green-600">Stahl</span>
            <span class="text-gray-400">&bull;</span>
            <span class="text-blue-600">Bahn</span>
        </div>
        <p class="text-sm text-gray-600">Die Symbiose aus Gruben, Hüttenwerken und Eisenbahnen (1815-2012).</p>
    </div>

    <!-- Header Mobile -->
    <div class="absolute top-0 left-0 right-0 z-[1000] glass-panel p-3 border-b border-gray-200 md:hidden flex justify-between items-center">
        <h1 class="text-lg font-bold text-gray-800 pl-2">Saarland Industriekultur</h1>
    </div>

    <!-- Sidebar Liste (Rechts) -->
    <div class="absolute top-16 md:top-4 right-4 bottom-12 w-64 md:w-80 z-[1000] flex flex-col pointer-events-none">
        <div class="glass-panel rounded-xl shadow-2xl flex flex-col max-h-full pointer-events-auto overflow-hidden">
            <div class="p-4 bg-gray-50 border-b border-gray-200">
                <h2 class="font-bold text-gray-700">Standorte & Epochen</h2>
                <p class="text-xs text-gray-500">Klicke zum Anfliegen</p>
            </div>
            <div id="locations-list" class="overflow-y-auto p-2 space-y-4 bg-white/50">
                <!-- Inhalt wird dynamisch generiert -->
            </div>
        </div>
    </div>

    <!-- Map -->
    <div id="map"></div>

    <!-- Footer -->
    <div class="absolute bottom-0 left-0 right-0 z-[1000] bg-gray-900 text-white text-xs py-2 px-4 text-center opacity-90">
        &copy; 2024 Historischer Atlas Saarland | Vibe-Coding
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // --- DATEN: LANDESGRENZE SAARLAND (Maximale Details) ---
        // Enthält deutlich mehr Stützpunkte für einen realistischen Verlauf
        const saarlandBorder = [
            // Nördliche Grenze (Nonnweiler bis Freisen)
            [49.630, 6.970], [49.640, 7.020], [49.625, 7.080], [49.600, 7.100],
            [49.580, 7.130], [49.570, 7.180], [49.550, 7.200], [49.540, 7.250],
            [49.520, 7.290], [49.500, 7.320], [49.480, 7.340],
            
            // Östliche Grenze (Homburg / Waldmohr / Einöd)
            [49.450, 7.380], [49.420, 7.420], [49.380, 7.430], [49.350, 7.420],
            [49.320, 7.400], [49.300, 7.380], [49.280, 7.360], [49.260, 7.370],
            [49.240, 7.350], [49.220, 7.300],
            
            // Südöstliche Grenze (Bliesgau)
            [49.180, 7.360], [49.160, 7.380], [49.140, 7.350], [49.120, 7.300],
            [49.110, 7.250], [49.120, 7.180], [49.130, 7.120],
            
            // Südliche Grenze (Kleinblittersdorf / Saargemünd / Saarbrücken Süd)
            [49.110, 7.080], [49.100, 7.040], [49.120, 7.000], [49.140, 6.980],
            [49.160, 6.950], [49.180, 6.920], [49.200, 6.900],
            
            // Warndt (Die charakteristische Einbuchtung nach Süden)
            [49.190, 6.880], [49.170, 6.850], [49.160, 6.800], // Tiefster Punkt Warndt
            [49.170, 6.750], [49.190, 6.720], [49.210, 6.700],
            [49.230, 6.680], // Überherrn Süd
            
            // Westliche Grenze (Saarlouis Land / Wallerfangen)
            [49.250, 6.650], [49.280, 6.620], [49.300, 6.600],
            [49.330, 6.640], [49.360, 6.660], [49.390, 6.620],
            [49.420, 6.580], [49.440, 6.520],
            
            // Die "Mosel-Nase" bei Perl (Westlichster Punkt)
            [49.460, 6.450], [49.470, 6.380], [49.475, 6.360], // Dreiländereck
            [49.500, 6.380], [49.520, 6.420], [49.540, 6.480],
            
            // Nordwestliche Grenze (Mettlach / Losheim)
            [49.550, 6.520], [49.540, 6.580], [49.550, 6.620],
            [49.570, 6.680], [49.590, 6.750], [49.610, 6.850],
            [49.620, 6.900], [49.630, 6.970] // Zurück zum Start
        ];

        // --- DATEN: BERGWERKE (Rot) mit ZEITRAUM ---
        const mines = [
            { id: "m1", name: "Grube Reden", location: "Schiffweiler", coords: [49.3493, 7.1132], desc: "Großbergwerk, heute 'Gondwana'.", period: "1846 – 1995" },
            { id: "m2", name: "Grube Göttelborn", location: "Quierschied", coords: [49.3548, 7.0335], desc: "Weißer Riese, markanter Förderturm IV.", period: "1887 – 2000" },
            { id: "m3", name: "Grube Camphausen", location: "Quierschied", coords: [49.3065, 7.0074], desc: "Backstein-Expressionismus Architektur.", period: "1871 – 1990" },
            { id: "m4", name: "Grube Ensdorf", location: "Ensdorf", coords: [49.3089, 6.7725], desc: "Letztes aktives Bergwerk (Saarpolygon).", period: "1833 – 2012" },
            { id: "m5", name: "Grube Luisenthal", location: "Völklingen", coords: [49.2477, 6.8938], desc: "Tiefstes Bergwerk an der Saar.", period: "1820 – 2005" },
            { id: "m6", name: "Grube Warndt", location: "Großrosseln", coords: [49.1864, 6.8097], desc: "Modernste Großschachtanlage.", period: "1963 – 2005" },
            { id: "m7", name: "Grube Velsen", location: "Großrosseln", coords: [49.2219, 6.8363], desc: "Erlebnisbergwerk heute.", period: "1899 – 2005" },
            { id: "m8", name: "Grube Itzenplitz", location: "Heiligenwald", coords: [49.3542, 7.0869], desc: "Ältestes erhaltenes Fördergerüst.", period: "1856 – 1960" },
            { id: "m9", name: "Grube Dechen", location: "Neunkirchen", coords: [49.3378, 7.1722], desc: "Eng verbunden mit dem Eisenwerk.", period: "1855 – 1968" },
            { id: "m10", name: "Grube Frankenholz", location: "Bexbach", coords: [49.3702, 7.2405], desc: "Ehemals tiefste Grube Bayerns.", period: "1879 – 1959" },
            { id: "m11", name: "Grube Maybach", location: "Friedrichsthal", coords: [49.3205, 7.0632], desc: "Bekannt durch Marie-Juchacz-Schacht.", period: "1873 – 1964" },
            { id: "m12", name: "Grube Viktoria", location: "Püttlingen", coords: [49.2927, 6.8882], desc: "Zentrale Rolle im Köllertal.", period: "1866 – 1963" },
            { id: "m13", name: "Grube Von der Heydt", location: "Saarbrücken", coords: [49.2688, 6.9575], desc: "Waldgrube mit Arbeitersiedlung.", period: "1850 – 1965" },
            { id: "m14", name: "Grube Jägersfreude", location: "Saarbrücken", coords: [49.2610, 7.0050], desc: "Wichtiger Standort an der Bahn.", period: "1856 – 1968" },
            { id: "m15", name: "Grube Kohlwald", location: "Wiebelskirchen", coords: [49.3680, 7.1980], desc: "Grenzgrube zu Bayern (Pfalz).", period: "1842 – 1966" },
            { id: "m16", name: "Grube St. Ingbert", location: "St. Ingbert", coords: [49.2830, 7.1180], desc: "Rischbachstollen.", period: "ca. 1770 – 1959" },
            { id: "m17", name: "Grube Hostenbach", location: "Wadgassen", coords: [49.2650, 6.7950], desc: "Bergbau im Bisttal.", period: "1816 – 1932" },
            { id: "m18", name: "Grube Dilsburg", location: "Heusweiler", coords: [49.3350, 6.9350], desc: "Schachtanlage der Grube Göttelborn.", period: "1911 – 1931" },
            { id: "m19", name: "Grube König", location: "Neunkirchen", coords: [49.3450, 7.1750], desc: "Historisch bedeutend für NK.", period: "1820 – 1968" },
            { id: "m20", name: "Grube Hirschbach", location: "Dudweiler", coords: [49.2850, 7.0450], desc: "Naherholungsgebiet heute.", period: "1816 – 1950" }
        ];

        // --- DATEN: STAHL- & HÜTTENWERKE (Grün) mit ZEITRAUM ---
        const steelworks = [
            { id: "s1", name: "Völklinger Hütte", location: "Völklingen", coords: [49.2485, 6.8442], desc: "UNESCO-Weltkulturerbe.", period: "1873 – 1986" },
            { id: "s2", name: "Dillinger Hütte", location: "Dillingen", coords: [49.3480, 6.7450], desc: "Grobblech-Spezialist.", period: "gegr. 1685 (aktiv)" },
            { id: "s3", name: "Neunkircher Eisenwerk", location: "Neunkirchen", coords: [49.3455, 7.1780], desc: "Prägte das Stadtbild extrem.", period: "1593 – 1982" },
            { id: "s4", name: "Burbacher Hütte", location: "Saarbrücken", coords: [49.2420, 6.9350], desc: "Teil von Saarstahl.", period: "gegr. 1856 (aktiv)" },
            { id: "s5", name: "Halberger Hütte", location: "Brebach", coords: [49.2180, 7.0300], desc: "Gussrohre und Motorteile.", period: "gegr. 1756 (aktiv)" },
            { id: "s6", name: "Alte Schmelz", location: "St. Ingbert", coords: [49.2750, 7.1050], desc: "Industriedenkmal.", period: "1733 – 1991" },
            { id: "s7", name: "Röhrenwerke Bous", location: "Bous", coords: [49.2750, 6.8050], desc: "Mannesmannröhren-Werke.", period: "gegr. 1887" },
            { id: "s8", name: "Eisenwerk Homburg", location: "Homburg", coords: [49.3250, 7.3350], desc: "Pfälzisch-saarländische Wirtschaft.", period: "ab 19. Jh." },
            { id: "s9", name: "Mariahütte", location: "Nonnweiler", coords: [49.6050, 6.9650], desc: "Eisenhütte im Hochwald.", period: "ab 17. Jh." },
            { id: "s10", name: "Geislauterner Eisenwerk", location: "Völklingen", coords: [49.2350, 6.8300], desc: "Wiege des Eisenwesens.", period: "1585 – 1875" },
            { id: "s11", name: "St. Ingberter Eisenwerk", location: "St. Ingbert", coords: [49.2800, 7.1200], desc: "Draht- und Nagelproduktion.", period: "1733 – 1991" },
            { id: "s12", name: "Hütte Krämer", location: "St. Ingbert", coords: [49.2720, 7.1150], desc: "Walzwerk-Tradition.", period: "19. Jh." },
            { id: "s13", name: "Eisenwerk Bettingen", location: "Schmelz", coords: [49.4350, 6.8600], desc: "Namensgebend für 'Schmelz'.", period: "1686 – 1868" },
            { id: "s14", name: "Aschbacher Eisenwerk", location: "Gersweiler", coords: [49.2300, 6.9100], desc: "Schmelze an der Saar.", period: "1724 – 1860" },
            { id: "s15", name: "Fischbacher Schmelze", location: "Quierschied", coords: [49.3150, 7.0400], desc: "Frühindustrielle Anlage.", period: "1728 – 1860" },
            { id: "s16", name: "Goffontaine", location: "Schafbrücke", coords: [49.2250, 7.0500], desc: "Eisenwerk und Drahtzug.", period: "18. Jh." },
            { id: "s17", name: "Wadgasser Hütte", location: "Wadgassen", coords: [49.2700, 6.7900], desc: "Kristallglas & Eisen.", period: "17. - 19. Jh." },
            { id: "s18", name: "Karlsbrunner Hütte", location: "Großrosseln", coords: [49.1850, 6.8300], desc: "Standort im Warndt.", period: "18. Jh." },
            { id: "s19", name: "Hütteweiler", location: "Illingen", coords: [49.3800, 7.0500], desc: "Frühe Verhüttung.", period: "Mittelalter" },
            { id: "s20", name: "Hütte Wecklingen", location: "Blieskastel", coords: [49.2300, 7.2500], desc: "Anlage im Bliestal.", period: "18. Jh." }
        ];

        // --- DATEN: BAHNSTRECKEN ---
        const railways = [
            { name: "Pfälzische Ludwigsbahn (1849)", color: "#1e40af", path: [[49.380, 7.350], [49.345, 7.260], [49.345, 7.180], [49.280, 7.110], [49.240, 7.000], [49.190, 6.890]] },
            { name: "Nahetalbahn (1860)", color: "#047857", path: [[49.550, 7.150], [49.450, 7.100], [49.350, 7.180], [49.260, 7.000]] },
            { name: "Saartalbahn (Trierer Linie)", color: "#b91c1c", path: [[49.240, 7.000], [49.250, 6.850], [49.310, 6.750], [49.380, 6.650], [49.450, 6.600], [49.600, 6.550]] },
            { name: "Fischbachtalbahn (1879)", color: "#d97706", path: [[49.240, 7.000], [49.300, 7.010], [49.330, 7.030], [49.350, 7.180]] }
        ];

        // --- MAP INIT ---
        const map = L.map('map', { zoomControl: false }).setView([49.35, 6.95], 11);
        L.control.zoom({ position: 'bottomright' }).addTo(map);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap, &copy; CARTO',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        // --- LANDESGRENZE ZEICHNEN (Hochdetailliert & Fein) ---
        L.polygon(saarlandBorder, {
            color: '#111827', // Fast schwarz (Tailwind gray-900)
            weight: 2, // Linie ist fein
            fill: false,
            opacity: 0.8,
            dashArray: '5, 5'
        }).addTo(map);

        // --- ICONS & LAYERS ---
        const minesLayer = L.layerGroup().addTo(map);
        const steelLayer = L.layerGroup().addTo(map);
        const railsLayer = L.layerGroup().addTo(map);

        const createIcon = (color) => L.divIcon({
            className: 'custom-div-icon',
            html: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 drop-shadow-md"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3" fill="white"></circle></svg>`,
            iconSize: [32, 32],
            iconAnchor: [16, 32],
            popupAnchor: [0, -25]
        });

        const markers = {};

        // --- RENDER FUNKTIONEN ---
        const listContainer = document.getElementById('locations-list');

        // Funktion zum Erstellen von Listen-Sektionen
        function addSection(title, colorClass, items, layer, iconColor, typeClass) {
            // Sektions-Header
            const header = document.createElement('div');
            header.className = `font-bold text-xs uppercase tracking-wider ${colorClass} mt-4 mb-2 pl-2`;
            header.innerText = title;
            listContainer.appendChild(header);

            items.forEach(item => {
                // Marker auf Karte
                const marker = L.marker(item.coords, {icon: createIcon(iconColor)}).addTo(layer);
                markers[item.id] = marker;

                // Popup Inhalt: Zeitstrahl Badge statt Bild
                const badgeColorBg = typeClass === 'mine-item' ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800';
                const popupContent = `
                    <div class="p-4">
                        <h3 class="font-bold text-lg ${colorClass} leading-tight mb-1">${item.name}</h3>
                        <p class="text-xs font-semibold text-gray-500 uppercase mb-2 flex justify-between">
                            <span>${item.location}</span>
                        </p>
                        <div class="inline-block ${badgeColorBg} text-xs px-2 py-1 rounded-md font-mono mb-3 border border-opacity-20 border-current">
                            ⏳ ${item.period}
                        </div>
                        <p class="text-sm text-gray-700 leading-snug">${item.desc}</p>
                    </div>
                `;
                marker.bindPopup(popupContent);

                // Liste Item
                const listItem = document.createElement('div');
                listItem.className = `list-item ${typeClass} p-3 rounded-lg cursor-pointer border-l-4 border-transparent bg-white shadow-sm mb-2`;
                listItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <h4 class="font-bold text-gray-800 text-sm">${item.name}</h4>
                    </div>
                    <div class="flex justify-between mt-1">
                        <span class="text-xs text-gray-500">${item.location}</span>
                        <span class="text-[10px] font-mono bg-gray-100 px-1 rounded text-gray-600">${item.period}</span>
                    </div>
                `;
                listItem.addEventListener('click', () => {
                    map.flyTo(item.coords, 13, { duration: 1.5 });
                    setTimeout(() => markers[item.id].openPopup(), 1500);
                });
                listContainer.appendChild(listItem);
            });
        }

        // Listen füllen
        addSection("Bergwerke (Kohle)", "text-red-700", mines, minesLayer, "#dc2626", "mine-item");
        addSection("Hüttenwerke (Stahl)", "text-green-700", steelworks, steelLayer, "#16a34a", "steel-item");

        // Bahnen zeichnen
        railways.forEach(rail => {
            L.polyline(rail.path, {
                color: rail.color,
                weight: 4,
                opacity: 0.6,
                dashArray: '10, 10',
                lineCap: 'round'
            }).bindPopup(`<b style="color:${rail.color}">${rail.name}</b>`).addTo(railsLayer);
        });

        // Layer Control
        const overlays = {
            "<span class='text-red-700 font-bold'>Bergwerke</span>": minesLayer,
            "<span class='text-green-700 font-bold'>Hüttenwerke</span>": steelLayer,
            "<span class='text-blue-700 font-bold'>Schienennetz</span>": railsLayer
        };
        L.control.layers(null, overlays, { position: 'topright' }).addTo(map);

    </script>
</body>
</html>
